(function(e){typeof define=="function"&&define.amd?define(["jquery"],e):e(jQuery)})(function(e){"use strict";e.fn.pin=function(t){var n=0,r=[],i=!1,s=e(window);t=t||{};var o=function(){for(var n=0,o=r.length;n<o;n++){var u=r[n];if(t.minWidth&&s.width()<=t.minWidth){u.parent().is(".pin-wrapper")&&u.unwrap(),u.css({width:"",left:"",top:"",position:""}),t.activeClass&&u.removeClass(t.activeClass),i=!0;continue}i=!1;var a=t.containerSelector?u.closest(t.containerSelector):e(document.body),f=u.offset(),l=a.offset(),c=u.offsetParent().offset();u.parent().is(".pin-wrapper")||u.wrap("<div class='pin-wrapper'>");var h=e.extend({top:80,bottom:0},t.padding||{});u.data("pin",{pad:h,from:(t.containerSelector?l.top:f.top)-h.top,to:l.top+a.height()-u.outerHeight()-h.bottom,end:l.top+a.height(),parentTop:c.top}),u.css({width:u.outerWidth()}),u.parent().css("height",u.outerHeight())}},u=function(){if(i)return;n=s.scrollTop();var o=[];for(var u=0,a=r.length;u<a;u++){var f=e(r[u]),l=f.data("pin");if(!l)continue;o.push(f);var c=l.from-l.pad.bottom,h=l.to-l.pad.top;if(c+f.outerHeight()>l.end){f.css("position","");continue}c<n&&h>n?(f.css("position")!=="fixed"&&f.css({left:f.offset().left,top:l.pad.top}).css("position","fixed"),t.activeClass&&f.addClass(t.activeClass)):n>=h?(f.css({left:"",top:h-l.parentTop+l.pad.top}).css("position","absolute"),t.activeClass&&f.addClass(t.activeClass)):(f.css({position:"",top:"",left:""}),t.activeClass&&f.removeClass(t.activeClass))}r=o},a=function(){o(),u()};return this.each(function(){var t=e(this),n=e(this).data("pin")||{};if(n&&n.update)return;r.push(t),e("img",this).one("load",o),n.update=a,e(this).data("pin",n)}),s.scroll(u),s.resize(function(){o()}),o(),s.load(a),this}});